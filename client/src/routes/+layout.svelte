<script lang="ts">
    import favicon from '$lib/assets/favicon.svg';
    import '../index.css';
    import { auth } from '$lib/stores/auth';

    let { children } = $props();

    function handleLogin() {
        window.location.href = 'http://localhost:3000/auth/github';
    }

    function handleLogout() {
        auth.logout();
    }
</script>

<svelte:head>
    <link rel="icon" href={favicon} />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800&family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
    <title>CSL Style Hub</title>
</svelte:head>

<div class="min-h-screen flex flex-col bg-background-light">
    <!-- Shared Header -->
    <header class="sticky top-0 z-50 flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 bg-white px-4 py-3 lg:px-10">
        <a href="/" class="flex items-center gap-4 hover:opacity-80 transition-opacity">
            <div class="size-8 text-primary flex items-center justify-center">
                <span class="material-symbols-outlined text-3xl">school</span>
            </div>
            <h2 class="text-lg font-bold leading-tight tracking-[-0.015em] text-slate-900">CSL Style Hub</h2>
        </a>
        <div class="hidden md:flex flex-1 justify-end gap-8">
            <nav class="flex items-center gap-9">
                <a class="text-sm font-medium text-slate-600 hover:text-primary transition-colors" href="/library/browse">Browse</a>
                <a class="text-sm font-medium text-slate-600 hover:text-primary transition-colors" href="/create-wizard">Wizard</a>
                {#if $auth.user}
                    <a class="text-sm font-medium text-slate-600 hover:text-primary transition-colors" href="/library">My Library</a>
                {/if}
                <a class="text-sm font-medium text-slate-600 hover:text-primary transition-colors" href="/">Docs</a>
            </nav>
            <div class="flex gap-2">
                {#if $auth.user}
                    <button 
                        onclick={handleLogout}
                        class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-slate-200 hover:bg-slate-300 text-slate-900 text-sm font-bold transition-colors">
                        Sign Out
                    </button>
                {:else}
                    <button 
                        onclick={handleLogin}
                        class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-white hover:bg-primary-dark text-sm font-bold transition-colors">
                        Sign In
                    </button>
                {/if}
            </div>
        </div>
    </header>

    <!-- Page Content -->
    <div class="flex-grow">
        {@render children()}
    </div>

    <!-- Shared Footer -->
    <footer class="border-t border-slate-100 bg-white px-10 py-16">
        <div class="max-w-[1200px] mx-auto flex flex-col md:flex-row justify-between gap-12">
            <div class="flex flex-col gap-4 max-w-sm">
                <div class="flex items-center gap-3">
                    <div class="size-6 text-primary flex items-center justify-center">
                        <span class="material-symbols-outlined text-2xl">school</span>
                    </div>
                    <span class="text-lg font-bold text-slate-900">CSL Style Hub</span>
                </div>
                <p class="text-sm text-slate-500 leading-relaxed">
                    An open-source initiative to modernize academic referencing. 
                    Maintained by the Citation Style Language community.
                </p>
            </div>
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-12">
                <div class="flex flex-col gap-4">
                    <h4 class="text-xs font-black text-slate-900 uppercase tracking-widest">Platform</h4>
                    <a class="text-sm text-slate-500 hover:text-primary" href="/library/browse">Browse</a>
                    <a class="text-sm text-slate-500 hover:text-primary" href="/create-wizard">Wizard</a>
                    <a class="text-sm text-slate-500 hover:text-primary" href="/">API</a>
                </div>
                <div class="flex flex-col gap-4">
                    <h4 class="text-xs font-black text-slate-900 uppercase tracking-widest">Help</h4>
                    <a class="text-sm text-slate-500 hover:text-primary" href="/">Docs</a>
                    <a class="text-sm text-slate-500 hover:text-primary" href="/">Forum</a>
                </div>
            </div>
        </div>
        <div class="mt-16 pt-8 border-t border-slate-100 text-center">
            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Â© 2024 CSL Style Hub. All rights reserved.</p>
        </div>
    </footer>
</div>
